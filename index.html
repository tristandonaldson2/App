<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WaySave ‚Äî Find Fun Your Way!</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <!-- Fredoka One font for all text -->
  <link href="https://fonts.googleapis.com/css?family=Fredoka+One:400&display=swap" rel="stylesheet">
  <!-- Favicon/logo -->
  <link rel="icon" type="image/png" href="logo.png">
  <style>
    :root {
      /* Brand/Logo palette based on provided image */
      --coral: #f44c36;
      --coral-dark: #c13d2c;
      --turquoise: #33c5e0;
      --turquoise-dark: #218bb1;
      --gold: #ffd13d;
      --gold-dark: #b9981f;
      --green: #2fcc5d;
      --green-dark: #1e8142;
      --bg: #fdf5ed;
      --text: #262626;
      --navy: #23243a;
      --shadow: 0 4px 16px 0 rgba(0,0,0,0.09), 0 0px 1.5px 0 #fff7;
      --glass: rgba(255,255,255,0.72);
      --card-radius: 28px;
      --pill-radius: 22px;
    }
    html, body {
      font-family: 'Fredoka One', 'Fredoka', Arial, sans-serif;
      background: var(--bg);
      color: var(--navy);
      margin: 0;
      padding: 0;
      font-size: 18px;
      letter-spacing: 0.02em;
      min-height: 100vh;
      overflow-x: hidden;
      box-sizing: border-box;
    }
    body {
      width: 100vw;
      max-width: 540px;
      margin: 0 auto;
      position: relative;
    }
    .hidden { display: none !important; }

    /* --- Animated Background (bubbles, clouds, coins) --- */
    .bg-bubble, .bg-coin, .bg-cloud, .bg-star {
      position: fixed;
      z-index: 0;
      opacity: 0.2;
      pointer-events: none;
      transition: transform 2s cubic-bezier(.77,0,.18,1);
      filter: blur(0.5px);
      animation: float 12s infinite linear;
    }
    .bg-bubble { width: 110px; height: 110px; border-radius: 50%; background: var(--turquoise); bottom: 13vh; left: -40px; }
    .bg-coin { width: 75px; height: 75px; border-radius: 50%; background: var(--gold); top: 6vh; right: -20px; box-shadow: 0 0 16px 4px #fffacb; }
    .bg-cloud { width: 140px; height: 60px; top: 0vh; left: 50vw; }
    .bg-star { width: 40px; height: 40px; top: 70vh; left: 90vw; background: none;}
    @keyframes float {
      0% { transform: translateY(0) scale(1);}
      20% { transform: translateY(-16px) scale(1.04);}
      40% { transform: translateY(7px) scale(0.97);}
      60% { transform: translateY(-13px) scale(1.02);}
      80% { transform: translateY(6px) scale(1);}
      100% { transform: translateY(0) scale(1);}
    }
    .bg-cloud svg, .bg-star svg { width: 100%; height: 100%;}

    /* --- Splash Screen --- */
    #splash {
      position: fixed;
      z-index: 9999;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: linear-gradient(135deg, var(--coral) 0%, #f59b36 80%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      animation: splashFade 4.2s cubic-bezier(.8,.2,.7,1.1);
      pointer-events: none;
      overflow: hidden;
      transition: opacity 0.8s;
    }
    @keyframes splashFade {
      0% { opacity: 1; }
      75% { opacity: 1; }
      100% { opacity: 0; }
    }
    .splash-logo {
      width: 132px;
      height: 132px;
      margin-bottom: 1.2em;
      background: none;
      border-radius: 26px;
      box-shadow: 0 6px 36px -12px #c13d2c80;
      animation: popIn 1.2s;
    }
    @keyframes popIn { 0% {transform: scale(0.7);} 100% {transform: scale(1);} }
    .splash-title {
      font-size: 2.5em;
      color: #fff;
      text-shadow: 0 3px 12px #0004,0 -1px 2px #fff6;
      margin-bottom: 0.5em;
      letter-spacing: 0.09em;
      animation: bounceTitle 2.1s infinite cubic-bezier(.6,.2,.7,1.1) alternate;
      text-align: center;
    }
    @keyframes bounceTitle {
      0% { transform: scale(1) rotate(-2deg);}
      60% { transform: scale(1.09) rotate(2deg);}
      100% { transform: scale(1) rotate(-2deg);}
    }
    .splash-savie {
      width: 72px; height: 72px; margin-bottom: 1.7em;
      animation: saviePop 1.6s infinite alternate;
    }
    @keyframes saviePop {
      0% { transform: scale(1);}
      40% { transform: scale(1.06);}
      100% { transform: scale(1);}
    }
    .splash-spinner {
      width: 45px; height: 45px;
      border: 7px solid #fff8;
      border-top: 7px solid var(--turquoise);
      border-radius: 50%;
      animation: spin 1.1s linear infinite;
      margin-top: 1em;
      margin-bottom: 2em;
    }
    @keyframes spin {0% {transform: rotate(0);} 100% {transform: rotate(360deg);}}

    /* --- Survey Onboarding --- */
    #survey {
      margin: 2em 1.2em 1.2em 1.2em;
      background: linear-gradient(120deg, #fff 70%, #ffe7b3 100%);
      border-radius: var(--card-radius);
      box-shadow: var(--shadow);
      padding: 2.1em 1.2em 1.4em 1.2em;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      animation: appear 0.9s;
      position: relative;
      z-index: 2;
    }
    @keyframes appear {
      from { transform: scale(0.93) translateY(48px); opacity: 0; }
      to   { transform: scale(1) translateY(0); opacity: 1; }
    }
    #survey h2 {
      font-size: 1.6em;
      color: var(--coral);
      text-align: center;
      margin-bottom: 0.7em;
      margin-top: -0.4em;
      letter-spacing: 0.04em;
    }
    .survey-group {
      margin-bottom: 1.08em;
    }
    .survey-label {
      font-size: 1.13em;
      color: var(--navy);
      margin-bottom: 0.22em;
      display: block;
      font-weight: 700;
      letter-spacing: 0.02em;
    }
    .survey-input, .survey-select {
      border: none;
      border-radius: var(--pill-radius);
      padding: 0.75em 1.1em;
      font-size: 1.06em;
      background: #f7fff6;
      color: var(--navy);
      box-shadow: 0 2px 7px rgba(0,0,0,0.04);
      font-family: 'Fredoka One', Arial, sans-serif;
      outline: none;
      width: 100%;
      margin-bottom: 0.13em;
      font-weight: 400;
    }
    .survey-input:focus, .survey-select:focus {
      background: #e7fce7;
      box-shadow: 0 0 0 2px var(--turquoise);
    }
    .survey-btn {
      margin-top: 1.1em;
      background: linear-gradient(90deg, var(--turquoise) 60%, var(--green) 100%);
      color: #fff;
      font-size: 1.12em;
      padding: 0.93em;
      border-radius: 18px;
      border: none;
      box-shadow: 0 2px 8px #33c5e030;
      cursor: pointer;
      font-weight: 700;
      transition: background 0.17s, transform 0.12s;
      font-family: 'Fredoka One', Arial, sans-serif;
      letter-spacing: 0.03em;
      outline: none;
      position: relative;
      z-index: 1;
    }
    .survey-btn:active { transform: scale(0.97);}
    .survey-btn:hover { background: linear-gradient(90deg,var(--green) 40%,var(--turquoise) 100%);}
    .survey-savie {
      position: absolute; right: -30px; bottom: -12px; z-index: 0;
      width: 80px; height: 80px; opacity: 0.93; pointer-events: none;
      animation: savieBlink 2.8s infinite alternate;
    }
    @keyframes savieBlink {
      0% { filter: brightness(1);}
      60% { filter: brightness(1.1);}
      100% { filter: brightness(0.92);}
    }

    /* --- Premium Popup Modal --- */
    #premium-popup {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 998;
      background: rgba(255, 209, 61, 0.96);
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeInPop 0.9s;
      flex-direction: column;
    }
    @keyframes fadeInPop {
      0% { opacity: 0; transform: scale(0.88);}
      100% { opacity: 1; transform: scale(1);}
    }
    .premium-card {
      background: #fffbe7;
      border-radius: 28px;
      box-shadow: 0 4px 28px #f59b3680;
      padding: 2.2em 1.8em 1.5em 1.8em;
      text-align: center;
      max-width: 340px;
      position: relative;
      animation: popCardBounce 1.1s;
      border: 2.5px solid var(--coral);
    }
    @keyframes popCardBounce {
      0% { transform: scale(0.9);}
      60% { transform: scale(1.06);}
      100% { transform: scale(1);}
    }
    .premium-title {
      font-size: 1.36em;
      color: var(--coral);
      margin-bottom: 0.55em;
      font-weight: 700;
      letter-spacing: 0.05em;
    }
    .premium-features {
      color: var(--navy);
      font-size: 1.08em;
      margin: 0.22em 0 1.1em 0;
      padding: 0;
      text-align: left;
      list-style: none;
      font-weight: 400;
    }
    .premium-features li {
      margin-bottom: 0.63em;
      padding-left: 0.7em;
      position: relative;
    }
    .premium-features li:before {
      content: "‚ú®";
      position: absolute;
      left: 0; top: 0;
    }
    .premium-price {
      font-size: 1.15em;
      color: var(--turquoise-dark);
      font-weight: 700;
    }
    .premium-countdown {
      margin: 1.1em 0 0.5em 0;
      font-size: 1.08em;
      color: var(--gold-dark);
      font-weight: 700;
      letter-spacing: 0.08em;
    }
    .premium-badge {
      position: fixed;
      bottom: 15px; right: 15px;
      background: var(--turquoise);
      color: #fff;
      border-radius: 50px;
      font-size: 1.08em;
      font-weight: 700;
      padding: 0.78em 1.35em;
      box-shadow: 0 2px 8px #33c5e04a;
      cursor: pointer;
      z-index: 900;
      display: flex;
      align-items: center;
      animation: badgeAppear 0.8s;
      border: 2px solid #fff;
      transition: background 0.15s;
    }
    .premium-badge:active { background: var(--green);}
    @keyframes badgeAppear {
      from { transform: scale(0.3) translateY(80px); opacity: 0;}
      to   { transform: scale(1) translateY(0); opacity: 1;}
    }
    .premium-badge-icon { margin-right: 0.55em; font-size: 1.2em;}

    /* --- Header & User Counter --- */
    .header {
      width: 100vw;
      max-width: 540px;
      background: linear-gradient(90deg, var(--coral) 90%, var(--gold) 100%);
      color: #fff;
      display: flex;
      align-items: center;
      border-radius: 0 0 32px 32px;
      box-shadow: 0 2px 12px #c13d2c30;
      justify-content: space-between;
      padding: 1.1em 1.4em 1.1em 1.1em;
      margin-bottom: 0.5em;
      position: sticky;
      top: 0; z-index: 3;
    }
    .header-logo {
      width: 53px; height:53px; border-radius: 16px; margin-right: 0.7em;
      background: #fff3;
      box-shadow: 0 2px 9px #fff4;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
    }
    .header-title {
      font-size: 1.35em;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-shadow: 0 2px 8px #c13d2c22;
      margin-right: 0.5em;
      white-space: nowrap;
    }
    .header-user {
      color: #fff;
      opacity: 0.93;
      font-size: 1em;
      background: var(--turquoise);
      border-radius: 18px;
      padding: 0.2em 0.85em;
      font-weight: 500;
      box-shadow: 0 1px 5px #33c5e02a;
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .header-user-emoji { font-size: 1.4em; }

    /* --- Live User Counter --- */
    .user-counter {
      text-align: center;
      font-size: 1.05em;
      color: var(--gold);
      background: var(--coral-dark);
      border-radius: 13px;
      padding: 0.25em 0.8em;
      margin: 0.5em auto 0.1em auto;
      box-shadow: 0 1px 7px #c13d2c36;
      max-width: 83vw;
      font-weight: 700;
      letter-spacing: 0.04em;
      display: inline-block;
      position: relative;
      z-index: 1;
      animation: userPulse 2.2s infinite alternate;
    }
    @keyframes userPulse {
      0% { filter: brightness(1);}
      50% { filter: brightness(1.08);}
      100% { filter: brightness(0.96);}
    }

    /* --- Filter Bar --- */
    .filter-bar {
      display: flex;
      gap: 0.7em;
      margin: 0.7em 0 0.4em 0;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      background: #fff7;
      padding: 0.7em 0.3em 0.7em 0.3em;
      border-radius: 20px;
      box-shadow: 0 1.2px 6px #33c5e012;
      position: sticky;
      top: 74px;
      z-index: 2;
    }
    .filter-select {
      border: 2px solid var(--turquoise);
      background: #fcf9fe;
      color: var(--navy);
      border-radius: var(--pill-radius);
      padding: 0.32em 0.8em;
      font-size: 1em;
      font-family: 'Fredoka One', Arial, sans-serif;
      font-weight: 500;
      transition: background 0.12s, border 0.1s;
      outline: none;
      margin: 0 0.15em;
      appearance: none;
      cursor: pointer;
    }
    .filter-select:focus, .filter-select:hover {
      background: #e7fce7;
      border: 2.5px solid var(--green);
    }

    /* --- Activity Feed --- */
    .section-title {
      font-size: 1.25em;
      color: var(--turquoise-dark);
      font-weight: 700;
      margin: 0.8em 0 0.5em 0.3em;
      letter-spacing: 0.05em;
      display: flex;
      align-items: center;
      gap: 0.45em;
    }
    .activity-list {
      display: flex;
      flex-direction: column;
      gap: 1.2em;
      margin-bottom: 1.3em;
    }
    /* Activity Card */
    .activity-card {
      background: linear-gradient(102deg, #fff 85%, #f2f7fa 100%);
      border-radius: var(--card-radius);
      box-shadow: var(--shadow);
      padding: 1.1em 1.1em 1.05em 1.1em;
      display: flex;
      gap: 1.13em;
      align-items: flex-start;
      position: relative;
      cursor: pointer;
      transition: box-shadow 0.14s, transform 0.12s;
      border: 2.5px solid var(--turquoise);
    }
    .activity-card:active, .activity-card.expanded { box-shadow: 0 7px 26px #33c5e029; transform: scale(1.04);}
    .activity-img {
      width: 78px; height: 78px; object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 1.5px 8px #33c5e018;
      border: 2px solid var(--coral);
      flex-shrink: 0;
      background: #fff;
      margin-right: 0.2em;
      display: block;
      position: relative;
      z-index: 1;
    }
    .activity-content {
      flex: 1;
      min-width: 0;
      display: flex; flex-direction: column;
      gap: 0.14em;
    }
    .activity-title {
      font-size: 1.11em;
      font-weight: 700;
      color: var(--turquoise-dark);
      margin-bottom: 0.08em;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 0.32em;
    }
    .activity-category {
      font-size: 0.98em;
      color: #888;
      margin-bottom: 0.1em;
      letter-spacing: 0.01em;
    }
    .activity-borough {
      font-size: 0.98em;
      color: var(--coral-dark);
      margin-bottom: 0.1em;
      font-weight: 500;
    }
    .activity-budget {
      font-size: 0.97em;
      color: var(--gold-dark);
      display: inline-block;
      margin-bottom: 0.13em;
      background: #fffbe4;
      border-radius: 14px;
      padding: 0.08em 0.5em;
      margin-right: 0.2em;
      font-weight: 700;
    }
    .activity-expand {
      display: none;
      margin-top: 0.41em;
      font-size: 0.96em;
      color: #222;
      position: relative;
      z-index: 1;
    }
    .activity-card.expanded .activity-expand { display: block; }
    .activity-desc {
      margin-bottom: 0.23em;
    }
    .activity-reviews {
      color: var(--green-dark);
      font-size: 0.95em;
      margin-bottom: 0.13em;
    }
    .activity-views {
      color: var(--gold-dark);
      font-size: 0.89em;
      margin-bottom: 0.09em;
    }
    .directions-btn {
      background: var(--gold);
      color: var(--navy);
      border: none;
      border-radius: 14px;
      padding: 0.38em 0.95em;
      font-family: 'Fredoka One', Arial, sans-serif;
      font-size: 0.96em;
      font-weight: 700;
      box-shadow: 0 1px 7px #ffd13d33;
      margin-top: 0.19em;
      margin-right: 0.35em;
      cursor: pointer;
      transition: background 0.15s;
    }
    .directions-btn:hover { background: var(--coral);}
    .badge-got {
      background: var(--green);
      color: #fff;
      border-radius: 14px;
      padding: 0.13em 0.7em;
      font-size: 0.93em;
      font-weight: 500;
      box-shadow: 0 1px 8px #2fcc5d44;
      margin-left: 0.3em;
      vertical-align: middle;
      letter-spacing: 0.01em;
      display: inline-block;
      animation: badgePop 0.7s;
    }
    @keyframes badgePop {
      0% { transform: scale(0.4);}
      60% { transform: scale(1.13);}
      100% { transform: scale(1);}
    }
    .sponsored-label {
      position: absolute; top: 0.9em; right: 1.2em;
      background: var(--gold-dark);
      color: #fff;
      border-radius: 13px;
      padding: 0.1em 0.7em;
      font-size: 0.92em;
      font-weight: 700;
      letter-spacing: 0.01em;
      z-index: 2;
      box-shadow: 0 1px 8px #ffd13d38;
    }
    /* Banner Ad */
    .ad-banner {
      background: var(--coral-dark);
      color: var(--gold);
      border-radius: 18px;
      font-size: 1.05em;
      font-weight: 700;
      margin: 0.5em 0;
      padding: 1em 1.3em;
      text-align: center;
      box-shadow: 0 1px 8px #c13d2c18;
      letter-spacing: 0.05em;
      border: 2px dashed var(--gold);
      display: flex;
      align-items: center;
      gap: 0.7em;
      justify-content: center;
      animation: adWobble 2.3s infinite alternate;
    }
    .ad-icon {
      font-size: 1.3em;
      margin-right: 0.44em;
      animation: iconWobble 1.4s infinite alternate;
    }
    @keyframes adWobble {
      0% { filter: brightness(1);}
      100% { filter: brightness(1.08);}
    }
    @keyframes iconWobble {
      0% { transform: rotate(-7deg) scale(0.95);}
      100%{ transform: rotate(7deg) scale(1.1);}
    }

    /* --- Live Events --- */
    .events-title {
      font-size: 1.22em;
      color: var(--green-dark);
      font-weight: 700;
      letter-spacing: 0.04em;
      margin: 1.1em 0 0.5em 0.4em;
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .event-list {
      display: flex;
      gap: 0.9em;
      overflow-x: auto;
      padding-bottom: 0.6em;
      margin-bottom: 1.1em;
      margin-left: 0.2em;
    }
    .event-card {
      background: linear-gradient(105deg, #fff 80%, #f2f7fa 100%);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 1.1em 1.2em 1em 1.2em;
      min-width: 215px;
      max-width: 250px;
      flex-shrink: 0;
      position: relative;
      border: 2px solid var(--green);
      animation: eventSlideIn 1s;
    }
    @keyframes eventSlideIn {
      from {transform: translateX(60px) scale(0.93); opacity:0;}
      to {transform: translateX(0) scale(1); opacity:1;}
    }
    .event-name {
      font-size: 1.08em;
      color: var(--coral-dark);
      font-weight: 700;
      margin-bottom: 0.1em;
    }
    .event-details {
      color: #444;
      font-size: 0.98em;
      margin-bottom: 0.1em;
    }
    .event-date {
      color: var(--gold-dark);
      font-size: 0.95em;
      margin-bottom: 0.09em;
    }
    .event-borough {
      color: var(--turquoise);
      font-size: 0.97em;
      font-weight: 500;
    }

    /* --- Gamified Extras --- */
    .gamified-title {
      font-size: 1.13em;
      color: var(--turquoise-dark);
      font-weight: 700;
      margin: 0.7em 0 0.3em 0.4em;
      letter-spacing: 0.03em;
    }
    /* Spinner Wheel */
    .spinner-wheel-container {
      margin: 1em 0 0.8em 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.4em;
    }
    .spinner-arrow {
      width: 0; height: 0;
      border-left: 19px solid transparent;
      border-right: 19px solid transparent;
      border-bottom: 37px solid var(--coral);
      margin-bottom: -10px;
      filter: drop-shadow(0 1px 7px #f59b3655);
    }
    .spinner-wheel {
      width: 170px; height: 170px;
      border-radius: 50%;
      margin: 0 auto;
      background: conic-gradient(var(--turquoise) 0 45deg, var(--gold) 45deg 90deg, var(--green) 90deg 135deg, var(--coral) 135deg 180deg, #fff 180deg 210deg, #ffe7b3 210deg 260deg, var(--turquoise) 260deg 310deg, var(--coral-dark) 310deg 360deg);
      box-shadow: 0 4px 18px #33c5e022;
      border: 5px solid #fff;
      display: flex; align-items: center; justify-content: center;
      position: relative;
      transition: transform 2.2s cubic-bezier(.48,1.6,.53,1.01);
      overflow: hidden;
    }
    .spinner-labels {
      position: absolute;
      width: 100%;
      height: 100%;
      left: 0; top: 0;
      pointer-events: none;
      color: #fff;
      font-size: 1.17em;
      font-family: 'Fredoka One';
      text-shadow: 0 2px 10px #0007,0 1px 1px #fff4;
    }
    .spinner-label {
      position: absolute;
      left: 50%; top: 50%;
      transform-origin: 0 -60px;
    }
    .spinner-result {
      font-size: 1.12em;
      color: var(--coral-dark);
      font-weight: 700;
      margin-top: 0.45em;
      text-align: center;
      animation: badgePop 0.6s;
    }
    .spinner-spin-btn {
      margin-top: 0.7em;
    }
    /* Badge Collection */
    .badge-list {
      display: flex;
      gap: 0.7em;
      flex-wrap: wrap;
      margin-bottom: 0.9em;
      margin-left: 0.3em;
    }
    .badge-item {
      width: 46px; height: 46px; background: var(--gold);
      border-radius: 50%; box-shadow: 0 3px 10px #ffd13d22;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.7em;
      color: var(--coral);
      border: 2.5px solid #fff;
      margin-bottom: 0.21em;
      animation: badgePop 0.7s;
      position: relative;
    }
    .badge-item.locked {
      filter: grayscale(0.85) blur(0.3px) brightness(0.8);
      opacity: 0.48;
    }
    .badge-label {
      text-align: center; font-size: 0.81em; color: #555; margin-top: -0.08em;
      font-family: 'Fredoka One';
      font-weight: 500;
    }
    /* This or That */
    .this-or-that-container {
      margin: 1em 0 0.7em 0;
      display: flex; flex-direction: column; align-items: center;
    }
    .this-or-that-title {
      font-size: 1.05em;
      color: var(--coral);
      font-weight: 700;
      margin-bottom: 0.3em;
    }
    .this-or-that-options {
      display: flex; gap: 1.2em;
    }
    .this-or-that-choice {
      background: linear-gradient(105deg, #fff 65%, #ffe7b3 100%);
      border-radius: 21px;
      box-shadow: 0 1.5px 7px #33c5e013;
      padding: 0.9em 1.3em;
      font-size: 1.09em;
      font-family: 'Fredoka One';
      color: var(--turquoise-dark);
      cursor: pointer;
      border: 2.5px solid var(--turquoise);
      font-weight: 700;
      transition: background 0.13s, transform 0.13s;
      min-width: 86px;
      min-height: 48px;
      text-align: center;
    }
    .this-or-that-choice:active { background: var(--coral); color: #fff; transform: scale(1.07);}
    .this-or-that-result {
      font-size: 1.1em;
      color: var(--green-dark);
      font-weight: 700;
      margin-top: 0.4em;
      min-height: 1.21em;
      text-align: center;
      animation: badgePop 0.7s;
    }
    .this-or-that-btn {
      margin-top: 0.3em;
      background: var(--green);
      color: #fff;
      border-radius: 14px;
      border: none;
      box-shadow: 0 1px 7px #2fcc5d22;
      font-size: 0.96em;
      font-family: 'Fredoka One', Arial, sans-serif;
      font-weight: 700;
      padding: 0.39em 1em;
      cursor: pointer;
      transition: background 0.15s;
    }
    .this-or-that-btn:hover { background: var(--turquoise);}
    /* Itinerary */
    .itinerary-container {
      margin: 1.1em 0 1em 0;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 1.5px 8px #33c5e013;
      padding: 1em 1em 0.7em 1em;
    }
    .itinerary-title {
      font-size: 1.08em;
      color: var(--gold-dark);
      font-weight: 700;
      margin-bottom: 0.35em;
    }
    .itinerary-list {
      list-style: none; padding: 0; margin: 0 0 0.5em 0;
    }
    .itinerary-item {
      margin-bottom: 0.12em;
      display: flex; align-items: center; gap: 0.6em;
      font-size: 1em;
    }
    .itinerary-check {
      width: 22px; height: 22px; border-radius: 50%;
      background: var(--green);
      color: #fff;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.1em;
      margin-right: 0.16em;
      box-shadow: 0 1px 6px #2fcc5d33;
      border: 2px solid #fff;
      cursor: pointer;
      transition: background 0.14s;
    }
    .itinerary-check.checked { background: var(--gold);}
    .itinerary-remove {
      background: none; border: none;
      color: var(--coral-dark);
      font-size: 1.16em;
      cursor: pointer;
      margin-left: 0.21em;
      font-family: 'Fredoka One';
      opacity: 0.85;
      transition: color 0.13s;
    }
    .itinerary-remove:hover { color: var(--turquoise);}
    .itinerary-input {
      width: 69%;
      border-radius: 13px;
      border: 2px solid var(--turquoise);
      padding: 0.42em 0.9em;
      font-size: 1em;
      font-family: 'Fredoka One', Arial, sans-serif;
      margin-right: 0.5em;
      margin-bottom: 0.3em;
      background: #fffbe7;
      color: var(--navy);
      outline: none;
      transition: border 0.13s;
    }
    .itinerary-input:focus { border: 2.5px solid var(--green);}
    .itinerary-add-btn {
      background: var(--gold-dark);
      color: #fff;
      border-radius: 11px;
      border: none;
      box-shadow: 0 1px 8px #ffd13d26;
      font-size: 0.98em;
      font-family: 'Fredoka One', Arial, sans-serif;
      font-weight: 700;
      padding: 0.39em 1em;
      cursor: pointer;
      transition: background 0.15s;
    }
    .itinerary-add-btn:hover { background: var(--green);}
    /* Weather */
    .weather-container {
      margin: 1.2em 0 1em 0;
      background: #f7fff6;
      border-radius: 20px;
      box-shadow: 0 1.5px 8px #33c5e013;
      padding: 1em 1em 0.7em 1em;
    }
    .weather-title {
      font-size: 1.07em;
      color: var(--turquoise-dark);
      font-weight: 700;
      margin-bottom: 0.33em;
    }
    .weather-list {
      display: flex;
      gap: 1em;
      flex-wrap: wrap;
      margin-bottom: 0.2em;
    }
    .weather-item {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 1px 7px #33c5e018;
      padding: 0.62em 0.8em;
      font-size: 0.96em;
      color: var(--navy);
      display: flex;
      align-items: center;
      gap: 0.6em;
      min-width: 89px;
    }
    .weather-emoji { font-size: 1.32em; }

    /* --- Savie AI Assistant --- */
    #savie-assistant {
      position: fixed;
      bottom: 24px; left: 14px;
      z-index: 966;
      display: flex;
      flex-direction: row;
      align-items: flex-end;
      gap: 0.5em;
      pointer-events: none;
      transition: left 0.3s, bottom 0.3s;
    }
    #savie-assistant.floating { left: 84vw; }
    .savie-avatar {
      width: 68px; height: 78px;
      cursor: pointer;
      animation: savieWalk 5.5s infinite;
      pointer-events: all;
      z-index: 2;
      border-radius: 19px;
      box-shadow: 0 3px 18px #33c5e045;
      background: #fff;
      transition: box-shadow 0.14s, transform 0.13s;
    }
    @keyframes savieWalk {
      0% { transform: translateY(0);}
      10% { transform: translateY(-8px) scale(1.04);}
      30% { transform: translateY(3px) scale(0.97);}
      50% { transform: translateY(-11px) scale(1.02);}
      80% { transform: translateY(2px) scale(1);}
      100% { transform: translateY(0);}
    }
    .savie-bubble {
      background: #fff;
      color: var(--turquoise-dark);
      border-radius: 19px 19px 21px 26px/22px 21px 33px 21px;
      box-shadow: 0 3.5px 18px #33c5e045, 0 2px 6px #ffd13d27;
      font-size: 1.09em;
      padding: 1em 1.2em 1em 1.2em;
      min-width: 210px;
      max-width: 330px;
      overflow-wrap: break-word;
      font-family: 'Fredoka One';
      font-weight: 500;
      pointer-events: all;
      margin-bottom: 0.7em;
      margin-left: 0.2em;
      position: relative;
      animation: appear 0.7s;
      z-index: 11;
    }
    .savie-bubble .savie-intro { font-size: 1em; color: var(--coral-dark);}
    .savie-bubble .suggest-btn {
      background: var(--turquoise);
      color: #fff;
      border-radius: 17px;
      border: none;
      font-family: 'Fredoka One';
      font-size: 1em;
      font-weight: 700;
      margin: 0.25em 0.21em;
      padding: 0.38em 0.89em;
      cursor: pointer;
      transition: background 0.13s;
      outline: none;
      box-shadow: 0 1px 6px #33c5e012;
      display: inline-block;
    }
    .savie-bubble .suggest-btn:active { background: var(--gold);}
    .savie-chat {
      margin: 0.5em 0 0.2em 0;
      font-size: 0.97em;
      color: #333;
      min-height: 1.2em;
      max-height: 140px;
      overflow-y: auto;
      font-family: 'Fredoka One';
    }
    .savie-msg {
      margin-bottom: 0.16em;
      display: block;
      animation: badgePop 0.5s;
    }
    .savie-msg.user { color: var(--coral-dark);}
    .savie-msg.savie { color: var(--turquoise-dark);}
    .savie-input-row {
      display: flex; gap: 0.5em; align-items: center;
      margin-top: 0.4em;
    }
    .savie-input {
      width: 75%;
      border-radius: 9px;
      border: 2px solid var(--turquoise);
      padding: 0.38em 0.8em;
      font-size: 1em;
      font-family: 'Fredoka One', Arial, sans-serif;
      background: #fffbe7;
      color: var(--navy);
      outline: none;
    }
    .savie-send-btn {
      background: var(--gold-dark);
      color: #fff;
      border-radius: 12px;
      border: none;
      font-size: 1.03em;
      font-family: 'Fredoka One';
      font-weight: 700;
      padding: 0.38em 1em;
      cursor: pointer;
      transition: background 0.15s;
    }
    .savie-send-btn:hover { background: var(--green);}
    .savie-close {
      background: none; border: none;
      color: #bbb;
      font-size: 1.12em;
      cursor: pointer;
      font-family: 'Fredoka One';
      position: absolute; top: 0.6em; right: 0.7em; opacity: 0.6;
      transition: color 0.13s;
    }
    .savie-close:hover { color: var(--coral-dark);}
    /* Responsive Mobile Only */
    @media only screen and (max-width: 600px) {
      html, body {
        font-size: 16px;
        max-width: 100vw;
        margin: 0; padding: 0;
      }
      .header, #main-feed, #live-events, #gamified-extras {
        padding-left: 0.1em; padding-right: 0.1em;
      }
      .savie-bubble { min-width: 160px; font-size: 0.97em;}
      .event-card { min-width: 160px; max-width: 180px;}
    }
    @media only screen and (max-width: 400px) {
      .premium-card, #survey, .savie-bubble { padding: 1em 0.2em 1em 0.2em;}
      .header {padding: 0.5em 0.5em;}
    }
  </style>
</head>
<body>
  <!-- Animated Background Bubbles/Clouds/Coins/Stars -->
  <div class="bg-bubble"></div>
  <div class="bg-coin"></div>
  <div class="bg-cloud">
    <svg viewBox="0 0 140 60"><ellipse cx="60" cy="40" rx="60" ry="18" fill="#fff"/><ellipse cx="100" cy="24" rx="30" ry="17" fill="#fff"/></svg>
  </div>
  <div class="bg-star">
    <svg viewBox="0 0 40 40"><polygon points="20,6 24,16 35,16 26,23 29,34 20,27 11,34 14,23 5,16 16,16" fill="#ffd13d"/></svg>
  </div>

  <!-- SPLASH SCREEN -->
  <div id="splash">
    <img src="logo.png" alt="WaySave Logo" class="splash-logo" draggable="false">
    <div class="splash-title">WaySave</div>
    <div class="splash-savie">
      <!-- Savie SVG face (mascot) -->
      <svg width="72" height="72" viewBox="0 0 72 72">
        <ellipse cx="36" cy="36" rx="30" ry="28" fill="#33c5e0"/>
        <ellipse cx="36" cy="40" rx="21" ry="15" fill="#fff"/>
        <ellipse cx="27" cy="41" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="45" cy="41" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="36" cy="54" rx="10" ry="5" fill="#ffd13d"/>
        <ellipse cx="36" cy="24" rx="6" ry="2" fill="#2fcc5d"/>
        <rect x="34" y="8" width="4" height="18" rx="2" fill="#2fcc5d"/>
        <circle cx="36" cy="8" r="3" fill="#ffd13d"/>
      </svg>
    </div>
    <div class="splash-spinner"></div>
  </div>
  <!-- SURVEY ONBOARDING -->
  <form id="survey" class="hidden" autocomplete="off">
    <h2>Let's Get Started!</h2>
    <div class="survey-group">
      <label class="survey-label" for="survey-name">Your Name</label>
      <input class="survey-input" id="survey-name" name="name" type="text" maxlength="16" autocomplete="off" required placeholder="Savie Jr., etc.">
    </div>
    <div class="survey-group">
      <label class="survey-label" for="survey-age">Age</label>
      <input class="survey-input" id="survey-age" name="age" type="number" min="11" max="25" required placeholder="13">
    </div>
    <div class="survey-group">
      <label class="survey-label" for="survey-borough">Borough</label>
      <select class="survey-select" id="survey-borough" name="borough" required>
        <option value="">Pick your borough!</option>
        <option value="Bronx">Bronx</option>
        <option value="Brooklyn">Brooklyn</option>
        <option value="Manhattan">Manhattan</option>
        <option value="Queens">Queens</option>
        <option value="Staten Island">Staten Island</option>
      </select>
    </div>
    <div class="survey-group">
      <label class="survey-label" for="survey-budget">Budget</label>
      <select class="survey-select" id="survey-budget" name="budget" required>
        <option value="">Your budget?</option>
        <option value="Free">Free</option>
        <option value="$">$</option>
        <option value="$$">$$</option>
        <option value="$$$">$$$</option>
      </select>
    </div>
    <button type="submit" class="survey-btn">Show Me Fun Stuff!</button>
    <div class="survey-savie">
      <!-- Savie SVG, mini -->
      <svg width="74" height="74" viewBox="0 0 72 72">
        <ellipse cx="36" cy="36" rx="30" ry="28" fill="#33c5e0"/>
        <ellipse cx="36" cy="40" rx="21" ry="15" fill="#fff"/>
        <ellipse cx="27" cy="41" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="45" cy="41" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="36" cy="54" rx="10" ry="5" fill="#ffd13d"/>
        <ellipse cx="36" cy="24" rx="6" ry="2" fill="#2fcc5d"/>
        <rect x="34" y="8" width="4" height="18" rx="2" fill="#2fcc5d"/>
        <circle cx="36" cy="8" r="3" fill="#ffd13d"/>
      </svg>
    </div>
  </form>
  <!-- PREMIUM POPUP MODAL -->
  <div id="premium-popup" class="hidden">
    <div class="premium-card">
      <div class="premium-title">Unlock <span style="color:var(--turquoise)">WaySave Premium!</span></div>
      <ul class="premium-features">
        <li>Secret NYC events</li>
        <li>Ad-free experience</li>
        <li>Exclusive games & badges</li>
        <li>Enhanced Savie AI</li>
      </ul>
      <div class="premium-price">Only $9.99/month</div>
      <div class="premium-countdown">Available in <span id="premium-timer">10</span>s</div>
    </div>
  </div>
  <div id="premium-badge" class="premium-badge hidden" onclick="showPremiumPopup()">
    <span class="premium-badge-icon">‚ú®</span> Premium
  </div>
  <!-- MAIN APP HEADER -->
  <div class="header hidden" id="header">
    <div class="header-logo"><img src="logo.png" alt="WaySave" style="width:98%;height:98%"></div>
    <div class="header-title" id="header-title">WaySave Discovery</div>
    <div class="header-user" id="header-user"><span class="header-user-emoji">üëã</span> <span id="header-username"></span></div>
  </div>
  <div class="user-counter hidden" id="live-user-counter">3,012,392 NYC teens online</div>
  <!-- FILTER BAR -->
  <div class="filter-bar hidden" id="filter-bar">
    <select id="filter-category" class="filter-select"></select>
    <select id="filter-borough" class="filter-select">
      <option value="">All Boroughs</option>
      <option value="Bronx">Bronx</option>
      <option value="Brooklyn">Brooklyn</option>
      <option value="Manhattan">Manhattan</option>
      <option value="Queens">Queens</option>
      <option value="Staten Island">Staten Island</option>
    </select>
    <select id="filter-budget" class="filter-select">
      <option value="">All Budgets</option>
      <option value="Free">Free</option>
      <option value="$">$</option>
      <option value="$$">$$</option>
      <option value="$$$">$$$</option>
    </select>
  </div>
  <!-- DISCOVERY FEED -->
  <div id="main-feed" class="hidden">
    <div class="section-title"><span>üé°</span> Find Fun Activities</div>
    <div class="activity-list" id="activity-list"></div>
  </div>
  <!-- LIVE EVENTS -->
  <div id="live-events" class="hidden">
    <div class="events-title"><span>üé§</span> Live NYC Events</div>
    <div class="event-list" id="event-list"></div>
  </div>
  <!-- GAMIFIED EXTRAS -->
  <div id="gamified-extras" class="hidden">
    <div class="gamified-title">üéØ Spin the Wheel!</div>
    <div class="spinner-wheel-container">
      <div class="spinner-arrow"></div>
      <div class="spinner-wheel" id="spinner-wheel"></div>
      <div class="spinner-result" id="spinner-result"></div>
      <button class="survey-btn spinner-spin-btn" id="spinner-spin-btn">Spin for Activity!</button>
    </div>
    <div class="gamified-title">üèÖ My Visit Badges</div>
    <div class="badge-list" id="badge-list"></div>
    <div class="gamified-title">ü§î This or That</div>
    <div class="this-or-that-container">
      <div class="this-or-that-title">Which would you pick?</div>
      <div class="this-or-that-options" id="this-or-that-options"></div>
      <div class="this-or-that-result" id="this-or-that-result"></div>
      <button class="this-or-that-btn" id="this-or-that-btn">New Choices!</button>
    </div>
    <div class="gamified-title">üóìÔ∏è My Itinerary</div>
    <div class="itinerary-container">
      <div class="itinerary-title">Today's Plans</div>
      <ul class="itinerary-list" id="itinerary-list"></ul>
      <input class="itinerary-input" id="itinerary-input" placeholder="Add activity...">
      <button class="itinerary-add-btn" id="itinerary-add-btn">Add</button>
    </div>
    <div class="gamified-title">üå¶Ô∏è Weather by Borough</div>
    <div class="weather-container">
      <div class="weather-title">What's it like outside?</div>
      <div class="weather-list" id="weather-list"></div>
    </div>
  </div>
  <!-- SAVIE AI ASSISTANT (floating mascot & chat) -->
  <div id="savie-assistant" class="hidden">
    <div class="savie-avatar" id="savie-avatar" title="Hi! I'm Savie. Tap to chat.">
      <svg width="68" height="78" viewBox="0 0 72 78">
        <ellipse cx="36" cy="39" rx="30" ry="28" fill="#33c5e0"/>
        <ellipse cx="36" cy="44" rx="21" ry="15" fill="#fff"/>
        <ellipse cx="27" cy="45" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="45" cy="45" rx="4" ry="6" fill="#262626"/>
        <ellipse cx="36" cy="62" rx="10" ry="5" fill="#ffd13d"/>
        <ellipse cx="36" cy="30" rx="6" ry="2" fill="#2fcc5d"/>
        <rect x="34" y="12" width="4" height="18" rx="2" fill="#2fcc5d"/>
        <circle cx="36" cy="12" r="3" fill="#ffd13d"/>
        <!-- Smile/mouth, animated by JS -->
        <ellipse id="savie-mouth" cx="36" cy="55" rx="7" ry="2.5" fill="#ff9b36"/>
      </svg>
    </div>
    <div class="savie-bubble hidden" id="savie-bubble">
      <button class="savie-close" id="savie-close" title="Close">√ó</button>
      <div class="savie-intro" id="savie-intro"></div>
      <div id="savie-suggestions"></div>
      <div class="savie-chat" id="savie-chat"></div>
      <div class="savie-input-row">
        <input type="text" id="savie-input" class="savie-input" placeholder="Ask Savie anything!">
        <button class="savie-send-btn" id="savie-send-btn">Send</button>
      </div>
    </div>
  </div>
  <script>
  // --- SPLASH LOGIC ---
  setTimeout(() => {
    document.getElementById('splash').style.opacity = '0';
    setTimeout(() => {
      document.getElementById('splash').classList.add('hidden');
      document.getElementById('survey').classList.remove('hidden');
    }, 800);
  }, 4000);

  // --- SURVEY LOGIC ---
  let userName = '';
  document.getElementById('survey').onsubmit = function(e) {
    e.preventDefault();
    userName = document.getElementById('survey-name').value || 'Friend';
    document.getElementById('survey').classList.add('hidden');
    document.getElementById('premium-popup').classList.remove('hidden');
    let t = 10;
    document.getElementById('premium-timer').textContent = t;
    const timerInt = setInterval(() => {
      t -= 1;
      document.getElementById('premium-timer').textContent = t;
      if (t <= 0) {
        clearInterval(timerInt);
        document.getElementById('premium-popup').classList.add('hidden');
        document.getElementById('premium-badge').classList.remove('hidden');
        document.getElementById('header').classList.remove('hidden');
        document.getElementById('filter-bar').classList.remove('hidden');
        document.getElementById('main-feed').classList.remove('hidden');
        document.getElementById('live-events').classList.remove('hidden');
        document.getElementById('gamified-extras').classList.remove('hidden');
        document.getElementById('live-user-counter').classList.remove('hidden');
        document.getElementById('header-username').textContent = userName;
        showSavieIntro();
      }
    }, 1000);
  };
  window.showPremiumPopup = function() {
    document.getElementById('premium-popup').classList.remove('hidden');
    document.getElementById('premium-badge').classList.add('hidden');
    let t = 10;
    document.getElementById('premium-timer').textContent = t;
    const timerInt = setInterval(() => {
      t -= 1;
      document.getElementById('premium-timer').textContent = t;
      if (t <= 0) {
        clearInterval(timerInt);
        document.getElementById('premium-popup').classList.add('hidden');
        document.getElementById('premium-badge').classList.remove('hidden');
      }
    }, 1000);
  };

  // --- LIVE USER COUNTER ---
  (function fluctuateCounter() {
    const el = document.getElementById('live-user-counter');
    if (!el) return;
    let base = 3012392;
    setInterval(() => {
      let r = Math.floor(Math.random()*12 - 4);
      base = Math.max(1000000, base + r);
      el.textContent = base.toLocaleString("en-US") + " NYC teens online";
    }, 2100);
  })();

  // --- FILTERS ---
  const categories = [
    "Amusement Parks","Tattoo Shops","Fast Food","Restaurants","Malls","Arcades","Skating Rinks",
    "Basketball Courts","Bookstores","Shoe Stores","Gyms","Flea Markets","Thrift Shops","Coffee Shops",
    "Rec Centers","Karaoke Bars","Bike Rentals","Rooftop Lounges","Pools","Beaches","Clothing Stores",
    "Museums","Escape Rooms","Live Music Venues"
  ];
  const categoryIcons = {
    "Amusement Parks":"üé¢", "Tattoo Shops":"üñãÔ∏è", "Fast Food":"üçî", "Restaurants":"üçΩÔ∏è",
    "Malls":"üõçÔ∏è", "Arcades":"üïπÔ∏è", "Skating Rinks":"‚õ∏Ô∏è", "Basketball Courts":"üèÄ", "Bookstores":"üìö",
    "Shoe Stores":"üëü", "Gyms":"üèãÔ∏è", "Flea Markets":"üß∫", "Thrift Shops":"üëï", "Coffee Shops":"‚òï",
    "Rec Centers":"üèì", "Karaoke Bars":"üé§", "Bike Rentals":"üö≤", "Rooftop Lounges":"üåá",
    "Pools":"üèä", "Beaches":"üèñÔ∏è", "Clothing Stores":"üëó", "Museums":"üèõÔ∏è", "Escape Rooms":"üö™",
    "Live Music Venues":"üé∏"
  };
  function renderFilters() {
    let catSel = document.getElementById('filter-category');
    catSel.innerHTML = `<option value="">All Categories</option>` + categories.map(c =>
      `<option value="${c}">${categoryIcons[c]||"üéà"} ${c}</option>`).join('');
  }
  renderFilters();

  // --- ACTIVITIES ---
  const activities = [
    {id: 1, title: "Coney Island Luna Park", category: "Amusement Parks", borough: "Brooklyn", budget: "$$", img: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=500&q=80", desc: "Classic rides, ocean views, and funnel cake. A must for thrill seekers!", reviews: ["So fun!! üé°", "Awesome for summer!", "I got soaked on the log ride."], views: 4572, sponsored: false, loc: "1000 Surf Ave, Brooklyn, NY 11224"},
    {id: 2, title: "NYPL - The Big Library", category: "Bookstores", borough: "Manhattan", budget: "Free", img: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=500&q=80", desc: "Chill in the grand reading room, study, or snap a staircase selfie üìö.", reviews: ["So pretty!", "I felt smart just walking in.", "Great for rainy days."], views: 2198, sponsored: false, loc: "476 5th Ave, NY 10018"},
    {id: 3, title: "Astoria Park Basketball Courts", category: "Basketball Courts", borough: "Queens", budget: "Free", img: "https://images.unsplash.com/photo-1517649763962-0c623066013b?auto=format&fit=crop&w=500&q=80", desc: "Open courts with skyline views. Challenge your friends!", reviews: ["The view is crazy!", "Good hoops.", "Bring water."], views: 3107, sponsored: false, loc: "19th St & Hoyt Ave N, Astoria, NY 11102"},
    {id: 4, title: "Thrift NYC", category: "Thrift Shops", borough: "Manhattan", budget: "$", img: "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=500&q=80", desc: "Score unique fits for cheap and snap some mirror pics üì∏.", reviews: ["So many cool clothes!", "Staff is super chill.", "Best finds in the city."], views: 1286, sponsored: false, loc: "23 W 8th St, NY 10011"},
    {id: 5, title: "Staten Island Mall", category: "Malls", borough: "Staten Island", budget: "$$", img: "https://images.unsplash.com/photo-1465101178521-c1a4fd487ffe?auto=format&fit=crop&w=500&q=80", desc: "Big food court, shopping, and frequent events. AC in summer!", reviews: ["Best mall in SI!", "Tons of stores.", "Food court slaps."], views: 2403, sponsored: true, loc: "2655 Richmond Ave, Staten Island, NY 10314"},
    {id: 6, title: "Bronx Zoo", category: "Museums", borough: "Bronx", budget: "$$", img: "https://images.unsplash.com/photo-1454023492550-5696f8ff10e1?auto=format&fit=crop&w=500&q=80", desc: "See lions, tigers, and bears (oh my)! Great for groups.", reviews: ["Animals everywhere!", "Love the butterfly garden.", "Wear comfy shoes."], views: 2328, sponsored: false, loc: "2300 Southern Blvd, Bronx, NY 10460"},
    {id: 7, title: "Brooklyn Bowl", category: "Live Music Venues", borough: "Brooklyn", budget: "$$", img: "https://images.unsplash.com/photo-1482062364825-616fd23b8fc1?auto=format&fit=crop&w=500&q=80", desc: "Live music and bowling! Great night out.", reviews: ["Bowled a strike!", "Vibes were üî•.", "Staff is cool."], views: 1749, sponsored: true, loc: "61 Wythe Ave, Brooklyn, NY 11249"},
    {id: 8, title: "Central Park Rec Center", category: "Rec Centers", borough: "Manhattan", budget: "Free", img: "https://images.unsplash.com/photo-1455656678494-4d1b5f3e7ad3?auto=format&fit=crop&w=500&q=80", desc: "Play basketball, swim, or just vibe with friends.", reviews: ["Love the pool!", "Great spot to chill.", "Lots of activities."], views: 1585, sponsored: false, loc: "5th Ave & 59th St, NY 10022"}
  ];
  let visitedBadges = {};
  function renderActivities() {
    let list = document.getElementById('activity-list');
    if (!list) return;
    let out = '';
    let n = 0;
    let cat = document.getElementById('filter-category').value;
    let bor = document.getElementById('filter-borough').value;
    let bud = document.getElementById('filter-budget').value;
    let filtered = activities.filter(a =>
      (!cat || a.category === cat) &&
      (!bor || a.borough === bor) &&
      (!bud || a.budget === bud)
    );
    filtered.forEach((a, i) => {
      // Insert ad banner every 2-3 cards
      if (i > 0 && i%2===0 && adBanners.length > 0) {
        let ad = adBanners[Math.floor(Math.random()*adBanners.length)];
        out += `<div class="ad-banner"><span class="ad-icon">${ad.icon}</span>${ad.text}</div>`;
      }
      out += `
      <div class="activity-card${a.sponsored ? " sponsored" : ""}${visitedBadges[a.id] ? " expanded" : ""}" data-id="${a.id}" onclick="toggleExpand(this,event)">
        ${a.sponsored ? `<div class="sponsored-label">Sponsored</div>` : ""}
        <img src="${a.img}" class="activity-img" alt="${a.title}">
        <div class="activity-content">
          <div class="activity-title">${categoryIcons[a.category] || "üéà"} ${a.title}${visitedBadges[a.id] ? '<span class="badge-got">üèÖ</span>' : ''}</div>
          <div class="activity-category">${a.category}</div>
          <div class="activity-borough">${a.borough}</div>
          <div class="activity-budget">${a.budget}</div>
          <div class="activity-expand">
            <div class="activity-desc">${a.desc}</div>
            <div class="activity-reviews">"${a.reviews.join('" <br> "')}"</div>
            <div class="activity-views">${a.views} views</div>
            <button class="directions-btn" onclick="event.stopPropagation();openDirections('${encodeURIComponent(a.loc)}')">Get Directions</button>
          </div>
        </div>
      </div>`;
      n++;
    });
    if (filtered.length === 0) {
      out = `<div style="padding:1.3em;text-align:center;color:#888;font-size:1.09em;">No activities match your filter ü§∑</div>`;
    }
    list.innerHTML = out;
  }
  window.toggleExpand = function(card,e) {
    if(e.target.classList.contains('directions-btn')) return;
    card.classList.toggle('expanded');
    let id = parseInt(card.getAttribute('data-id'));
    if (!visitedBadges[id]) {
      visitedBadges[id] = true;
      showBadgePopup(id);
      renderBadges();
    }
  };
  window.openDirections = function(address) {
    window.open("https://maps.apple.com/?q=" + address, "_blank");
  };
  const adBanners = [
    {text: "Try the Best Bodega Bagels! ü•Ø", icon:"üóΩ"},
    {text: "Visit NYC's Coolest Rooftop!", icon:"üåÜ"},
    {text: "See Spider-Man on Broadway!", icon:"üï∑Ô∏è"},
    {text: "Don't miss the Free Skate Night!", icon:"üõπ"},
    {text: "Sponsored: Find your next tattoo!", icon:"üñãÔ∏è"},
  ];
  // Filter bar listeners
  document.getElementById('filter-category').onchange =
  document.getElementById('filter-borough').onchange =
  document.getElementById('filter-budget').onchange = renderActivities;

  // --- EVENTS ---
  const liveEvents = [
    {name: "Central Park Summer Fest", details: "Live bands, food trucks, and free t-shirts.", date: "Aug 10, 2025", borough: "Manhattan"},
    {name: "Brooklyn Flea Market", details: "Vintage finds, music, and games.", date: "Aug 12, 2025", borough: "Brooklyn"},
    {name: "Bronx Street Parade", details: "Colorful floats, local performers, candy giveaways.", date: "Aug 15, 2025", borough: "Bronx"},
    {name: "Queens Pop-Up Shop", details: "Limited edition sneakers and snacks.", date: "Aug 9, 2025", borough: "Queens"},
    {name: "Staten Island Pool Bash", details: "DJ pool party, free snow cones.", date: "Aug 14, 2025", borough: "Staten Island"}
  ];
  function renderEvents() {
    let list = document.getElementById('event-list');
    if (!list) return;
    let out = '';
    liveEvents.forEach(evt => {
      out += `
      <div class="event-card">
        <div class="event-name">${evt.name}</div>
        <div class="event-details">${evt.details}</div>
        <div class="event-date">${evt.date}</div>
        <div class="event-borough">${evt.borough}</div>
      </div>`;
    });
    list.innerHTML = out;
  }
  // --- GAMIFIED EXTRAS ---
  // Spinner Wheel
  const spinnerOptions = [
    { label: "Go to the Beach! üèñÔ∏è", color: "var(--turquoise)"},
    { label: "Try a Thrift Shop! üëï", color: "var(--gold)"},
    { label: "Visit an Arcade! üïπÔ∏è", color: "var(--coral)"},
    { label: "Get Bubble Tea! üßã", color: "var(--green)"},
    { label: "Basketball at the Park! üèÄ", color: "var(--gold-dark)"},
    { label: "Photo Walk! üì∏", color: "var(--coral-dark)"}
  ];
  function renderSpinner() {
    let wheel = document.getElementById('spinner-wheel');
    if (!wheel) return;
    wheel.innerHTML = '';
    // Optionally show labels positioned around wheel
    let labels = document.createElement('div');
    labels.className = 'spinner-labels';
    spinnerOptions.forEach((opt,i) => {
      let angle = (360/spinnerOptions.length)*i;
      let lab = document.createElement('div');
      lab.className = 'spinner-label';
      lab.style.transform = `rotate(${angle}deg) translateY(-70px)`;
      lab.textContent = opt.label.split(' ')[0];
      labels.appendChild(lab);
    });
    wheel.appendChild(labels);
  }
  document.getElementById('spinner-spin-btn').onclick = function() {
    let idx = Math.floor(Math.random()*spinnerOptions.length);
    let deg = 360*3 + (360/spinnerOptions.length)*idx + (360/spinnerOptions.length)/2;
    let wheel = document.getElementById('spinner-wheel');
    wheel.style.transform = `rotate(-${deg}deg)`;
    setTimeout(()=>{
      document.getElementById('spinner-result').textContent = spinnerOptions[idx].label;
    }, 2100);
    setTimeout(()=>{wheel.style.transform='';}, 3200);
  };
  // Badges
  function renderBadges() {
    let list = document.getElementById('badge-list');
    if (!list) return;
    let out = '';
    activities.forEach(a => {
      out += `<div class="badge-item${visitedBadges[a.id] ? '' : ' locked'}" title="${a.title}">${categoryIcons[a.category] || "üèÖ"}</div>`;
    });
    list.innerHTML = out;
  }
  function showBadgePopup(id) {
    // show a badge pop animation or confetti with mascot
    // (for brevity, just alert, but you can use a real popup!)
    //alert("üèÖ You got a badge for visiting: " + activities.find(a=>a.id===id).title);
  }
  // This or That Game
  function renderThisOrThat() {
    let opts = [];
    while (opts.length < 2) {
      let idx = Math.floor(Math.random()*activities.length);
      if (!opts.includes(idx)) opts.push(idx);
    }
    let o1 = activities[opts[0]];
    let o2 = activities[opts[1]];
    let el = document.getElementById('this-or-that-options');
    el.innerHTML = `
      <div class="this-or-that-choice" onclick="pickThisOrThat('${o1.title}')">${categoryIcons[o1.category] || "üéà"} ${o1.title}</div>
      <div class="this-or-that-choice" onclick="pickThisOrThat('${o2.title}')">${categoryIcons[o2.category] || "üéà"} ${o2.title}</div>
    `;
    document.getElementById('this-or-that-result').textContent = '';
  }
  window.pickThisOrThat = function(choice) {
    document.getElementById('this-or-that-result').textContent = `You picked: ${choice}!`;
  };
  document.getElementById('this-or-that-btn').onclick = renderThisOrThat;

  // Itinerary
  let itinerary = [];
  function renderItinerary() {
    let list = document.getElementById('itinerary-list');
    if (!list) return;
    let out = '';
    itinerary.forEach((item,i) => {
      out += `<li class="itinerary-item">
        <span class="itinerary-check${item.checked?' checked':''}" onclick="toggleItinerary(${i})">${item.checked?'‚úîÔ∏è':'‚óã'}</span>
        ${item.text}
        <button class="itinerary-remove" onclick="removeItinerary(${i})" title="Remove">√ó</button>
      </li>`;
    });
    list.innerHTML = out;
  }
  window.toggleItinerary = function(i) {
    itinerary[i].checked = !itinerary[i].checked;
    renderItinerary();
  };
  window.removeItinerary = function(i) {
    itinerary.splice(i,1);
    renderItinerary();
  };
  document.getElementById('itinerary-add-btn').onclick = function() {
    let inp = document.getElementById('itinerary-input');
    let txt = inp.value.trim();
    if (txt) itinerary.push({text:txt,checked:false});
    inp.value = '';
    renderItinerary();
  };

  // Weather
  const weatherEmojis = ["‚òÄÔ∏è","üå§Ô∏è","üå¶Ô∏è","üåßÔ∏è","‚õÖ","üå©Ô∏è"];
  function renderWeather() {
    let list = document.getElementById('weather-list');
    let boroughs = ["Bronx","Brooklyn","Manhattan","Queens","Staten Island"];
    let out = '';
    boroughs.forEach(b=>{
      let emoji = weatherEmojis[Math.floor(Math.random()*weatherEmojis.length)];
      let temp = 65 + Math.floor(Math.random()*15);
      out += `<div class="weather-item"><span class="weather-emoji">${emoji}</span> ${b}<br><span style="font-size:0.9em;color:#888;">${temp}¬∞F</span></div>`;
    });
    list.innerHTML = out;
  }

  // --- SAVIE AI Mascot ---
  let savieActive = false, savieFloating = false, savieWaving = false;
  function showSavieIntro() {
    document.getElementById('savie-assistant').classList.remove('hidden');
    setTimeout(()=>showSavieBubble(true), 1200);
  }
  function showSavieBubble(intro=false) {
    let bubble = document.getElementById('savie-bubble');
    bubble.classList.remove('hidden');
    let introMsg = `Hey <b>${userName||'Friend'}</b>! I'm <span style="color:var(--turquoise)">Savie</span>, your fun-finding friend.<br>
      <span style="color:var(--coral)">Ask me anything, or tap around to explore NYC!</span>`;
    document.getElementById('savie-intro').innerHTML = intro ? introMsg : '';
    document.getElementById('savie-suggestions').innerHTML = `
      <button class="suggest-btn" onclick="savieAsk('What‚Äôs fun nearby?')">What‚Äôs fun nearby?</button>
      <button class="suggest-btn" onclick="savieAsk('Plan a hangout')">Plan a hangout</button>
      <button class="suggest-btn" onclick="savieAsk('Show trending spots')">Show trending spots</button>
    `;
    document.getElementById('savie-chat').innerHTML = '';
  }
  document.getElementById('savie-avatar').onclick = function() {
    let bubble = document.getElementById('savie-bubble');
    if (bubble.classList.contains('hidden')) showSavieBubble();
    else bubble.classList.add('hidden');
  };
  document.getElementById('savie-close').onclick = function() {
    document.getElementById('savie-bubble').classList.add('hidden');
  };
  document.getElementById('savie-send-btn').onclick = function() {
    let input = document.getElementById('savie-input');
    let chat = document.getElementById('savie-chat');
    let val = input.value.trim();
    if (!val) return;
    chat.innerHTML += `<div class="savie-msg user">${val}</div>`;
    input.value = '';
    setTimeout(() => {
      let reply = savieReply(val);
      chat.innerHTML += `<div class="savie-msg savie">${reply}</div>`;
      chat.scrollTop = chat.scrollHeight;
      savieAnimateFace();
    }, 700);
    chat.scrollTop = chat.scrollHeight;
  };
  document.getElementById('savie-input').onkeydown = function(e){
    if(e.key==="Enter") document.getElementById('savie-send-btn').click();
  };
  function savieAsk(msg) {
    document.getElementById('savie-input').value = msg;
    document.getElementById('savie-send-btn').click();
  }
  function savieReply(q) {
    let lower = q.toLowerCase();
    if (lower.includes("fun") || lower.includes("activity")) return "Try spinning the wheel below, or check out the trending events! üé°";
    if (lower.includes("plan") || lower.includes("hangout")) return "How about a photo walk, then bubble tea, then arcade games? Add them to your itinerary!";
    if (lower.includes("trending") || lower.includes("popular")) return "Coney Island and Brooklyn Bowl are trending now! üöÄ";
    if (lower.includes("free")) return "Check out the library, basketball courts, or rec centers for free fun!";
    if (lower.includes("weather")) return "It's sunny in Manhattan and cloudy in Brooklyn right now! Scroll down for live weather ‚õÖ";
    if (lower.includes("hello") || lower.includes("hi") || lower.includes("hey")) return "Hey there! Need help? I'm always here!";
    if (lower.includes("badge")) return "Earn badges by visiting activities! Try tapping a card to collect one!";
    return "I'm here to help you find stuff, play games, and have fun. Ask anything!";
  }
  function savieAnimateFace() {
    // Animate Savie's mouth for a smile or wow!
    let mouth = document.getElementById('savie-mouth');
    if (!mouth) return;
    mouth.setAttribute('rx', 7 + Math.floor(Math.random()*3));
    mouth.setAttribute('ry', 2.5 + Math.floor(Math.random()*2));
    setTimeout(()=>{mouth.setAttribute('rx',7);mouth.setAttribute('ry',2.5);}, 1000);
  }
  // Savie walks/floats around!
  setInterval(()=>{
    let savie = document.getElementById('savie-assistant');
    if (!savie || savie.classList.contains('hidden')) return;
    let pos = Math.random()>0.5 ? 'left' : 'right';
    let bottom = 24 + Math.floor(Math.random()*40);
    let left = pos==='left'?14:(window.innerWidth-92);
    savie.style.left = left+'px';
    savie.style.bottom = bottom+'px';
  },4800);

  // --- INITIAL RENDER ---
  renderActivities();
  renderEvents();
  renderSpinner();
  renderBadges();
  renderThisOrThat();
  renderItinerary();
  renderWeather();

  // Re-render on filter change or after badge
  document.getElementById('filter-category').onchange =
  document.getElementById('filter-borough').onchange =
  document.getElementById('filter-budget').onchange = renderActivities;

  </script>
</body>
</html>
